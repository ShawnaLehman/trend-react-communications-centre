var niceRichEditor,allFacts,selectedFact=0,updateEditorCreated;$(document).ready(function(){$("#loadingDiv").hide(),$("#content").show(),initRichEditor("textAreaContents"),$("#EditTipDiv").hide(),$("#saveBtn").on("click",function(){selectedFact?submitForm():postFact()}),$("#delBtn").on("click",function(){confirm("Are you sure you want to delete this fact?")&&delFact()}),$("#cancelBtn").on("click",function(){cancelEditor("#EditTipDiv")}),$("#editBtn").on("click",function(){showEditor("textAreaContents","#EditTipDiv",!0)}),$("#addTipBtn").on("click",function(){highlightSelectedFact(!1),showEditor("textAreaContents","#EditTipDiv",!1)}),ajax()});var submitForm=function(){var a=allFacts[selectedFact].id,b=getRichEditorContents("textAreaContents");RestAPI.request("fact","PUT",Array(a),{contents:b},callbackFact)},postFact=function(){var a=getRichEditorContents("textAreaContents");RestAPI.request("fact","POST",Array(),{contents:a},callbackPOSTFact)},delFact=function(){var a=allFacts[selectedFact].id;RestAPI.request("delFact","PUT",Array(a),null,callbackDelFact)},callbackDelFact=function(){redirect("factsu.html")},callbackFact=function(){redirect("factsu.html")},callbackPOSTFact=function(){redirect("factsu.html")},ajax=function(){RestAPI.request("allFacts","GET",Array(),null,callbackAllFacts)},callbackAllFacts=function(a){if(a.result){allFacts=a.result;var b;loadFact(0);for(var c="grayBGColor",d=0;d<allFacts.length;d++){b=allFacts[d],c=c?"":"grayBGColor";var e=$("<div>");e.addClass("row clickable hoverClass "+c),e.css({"padding-bottom":"15px","padding-left":"10px","padding-top":"15px"}),e.attr({id:d});var f=$("<div>");f.addClass("col col-xs-9");var g=b.contents.substring(0,50)+"...";f.html(g);var h=$("<div>");h.addClass("col col-xs-3 gray"),h.text(simpleFormat(b.dateAdded,"fancyDateMonth")),e.append(f),e.append(h),$("#allTipsDiv").append(e),highlightSelectedFact("0"),e.on("click",function(){loadFact(this.id),highlightSelectedFact(this.id)})}}},loadFact=function(a){$("#FactDate").empty(),$("#FactText").empty();var b=simpleFormat(allFacts[a].dateAdded,"fancyDateMonth");$("#FactDate").text("Created "+b);var c=allFacts[a].contents;$("#FactText").html(c),setRichEditorContents("textAreaContents",allFacts[a].contents)},highlightSelectedFact=function(a){a?($("#"+selectedFact).removeClass("trendBKColor"),$("#"+a).addClass("trendBKColor"),selectedFact=a,updateEditorCreated&&setRichEditorContents("textAreaContents",allFacts[a].contents)):$("#"+selectedFact).removeClass("trendBKColor")},showEditor=function(a,b,c){$("#viewTipDiv").hide(),$(b).show(),c?(setRichEditorContents("textAreaContents",allFacts[selectedFact].contents),updateEditorCreated=!0):(setRichEditorContents("textAreaContents",""),$("#FactDate").hide(),selectedFact=0),$("#addTipBtn").hide()},cancelEditor=function(a){$("#viewTipDiv").show(),$("#FactDate").show(),$("#addTipBtn").show(),$(a).hide(),highlightSelectedFact("0"),loadFact("0")};